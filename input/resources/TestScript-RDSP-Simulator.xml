<TestScript xmlns="http://hl7.org/fhir">
    <id value="RDSP-Simulator"/>
    <url value="https://build.fhir.org/ig/HL7/fhir-radiation-dose-summary-ig/TestScript-RDSP-Simulator.json"/>
    <name value="TestScript_RDSP_Simulator"/>
    <status value="active"/>
    <date value="2021-07-17"/>
    <publisher value="HL7 Imaging Integration Workgroup"/>
    <contact>
        <name value="HL7 Imaging Integration Workgroup"/>
        <telecom>
            <system value="url"/>
            <value value="http://www.hl7.org/Special/committees/imagemgt/index.cfm"/>
        </telecom>
    </contact>
    <contact>
        <name value="Abderrazek Boufahja"/>
        <telecom>
            <system value="email"/>
            <value value="abderrazek.boufahja@ge.com"/>
        </telecom>
    </contact>
    <description value="TestScript to validate the FHIR Server capabilities against an RDSP actor."/>
    <copyright value="HL7 2021"/>
    <origin>
        <index value="1"/>
        <profile>
            <system value="http://terminology.hl7.org/CodeSystem/testscript-profile-origin-types"/>
            <code value="FHIR-Client"/>
            <display value="FHIR Client"/>
        </profile>
    </origin>
    <destination>
        <index value="1"/>
        <profile>
            <system value="http://terminology.hl7.org/CodeSystem/testscript-profile-destination-types"/>
            <code value="FHIR-Server"/>
            <display value="FHIR Server"/>
        </profile>
    </destination>
    <metadata>
        <link>
            <url value="https://build.fhir.org/ig/HL7/fhir-radiation-dose-summary-ig/"/>
            <description value="This IG standardizes the sharing of minimal radiation information following a performed exam."/>
        </link>
        <capability>
            <required value="true"/>
            <validated value="false"/>
            <description value="The Capability requirements for the RDSP actor"/>
            <origin value="1"/>
            <link value="https://build.fhir.org/ig/HL7/fhir-radiation-dose-summary-ig/CapabilityStatement-RDSP.html"/>
            <capabilities value="http://hl7.org/fhir/uv/radiation-dose-summary/CapabilityStatement/RDSP"/>
        </capability>
        <capability>
            <required value="true"/>
            <validated value="false"/>
            <description value="The Capability requirements for the FHIR Server actor"/>
            <destination value="1"/>
            <link value="https://build.fhir.org/ig/HL7/fhir-radiation-dose-summary-ig/CapabilityStatement-FHIRServer-RDSP.html"/>
            <capabilities value="http://hl7.org/fhir/uv/radiation-dose-summary/CapabilityStatement/FHIRServer-RDSP"/>
        </capability>
    </metadata>
    <fixture id="rds-post-json"> 
        <autocreate value="false"/>  
        <autodelete value="false"/>  
        <resource> 
            <reference value="bundle-sample.json"/> 
        </resource> 
    </fixture>
    <test>
        <name value="RDS-Queries-verification"/>
        <description value="This is a Test to validate the FHIR server capabilities according to Radiation Dose Summary searching possibilities."/>
        <!-- Submit the RDS resource and the contextual resources -->
        <action> 
            <operation> 
                <type> 
                    <system value="http://terminology.hl7.org/CodeSystem/testscript-operation-codes"/>  
                    <code value="transaction"/> 
                </type>  
                <description value="Submit a bundle of resources creating the radiation dose summary"/>  
                <accept value="json"/>  
                <contentType value="json"/>  
                <destination value="1"/>  
                <encodeRequestUrl value="true"/> 
                <responseId value="bundle-post-response"/>
                <sourceId value="rds-post-json"/>
            </operation> 
        </action>
        <action> 
            <assert> 
                <description value="Confirm that the returned HTTP status is 200(OK)."/>  
                <direction value="response"/>  
                <operator value="in"/>  
                <responseCode value="200"/>  
                <warningOnly value="false"/> 
            </assert> 
        </action>
        <action> 
            <assert> 
                <description value="Confirm that the response body contains a Bundle"/>  
                <direction value="response"/>  
                <resource value="Bundle"/>  
                <warningOnly value="false"/> 
            </assert> 
        </action>
    </test>
</TestScript>
